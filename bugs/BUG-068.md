# BUG-068: list_change_groups is not a standard Q-SYS API method

**Status**: Open  
**Severity**: Low  
**Priority**: P3 (Low)  
**Component**: Change Group Tools  
**Reported Date**: 2025-01-22  
**Reporter**: Code Analysis  
**Assignee**: Unassigned  

## Summary
The list_change_groups tool appears to be a standard Q-SYS command but is actually a custom MCP-specific method, which could confuse users expecting Q-SYS API compatibility.

## Description
All other Change Group tools map directly to Q-SYS JSON-RPC methods (ChangeGroup.AddControl, ChangeGroup.Poll, etc.), but list_change_groups is implemented as a custom method on the adapter. This inconsistency could confuse users who expect it to work with other Q-SYS clients or wonder why it's not in the Q-SYS documentation.

## Steps to Reproduce
1. Review Q-SYS API documentation for Change Group methods
2. Look for ChangeGroup.List or similar method
3. Expected: Find corresponding Q-SYS API method
4. Actual: No such method exists in Q-SYS API

## Expected Behavior
The tool description should clearly indicate this is an MCP-specific convenience method, not part of the standard Q-SYS API.

## Actual Behavior
The tool is presented alongside standard Q-SYS methods without distinction, implying it's part of the same API.

## Environment
- **OS**: All
- **Node.js Version**: All supported versions
- **Project Version/Commit**: Current main branch
- **Q-SYS Core Version**: N/A (not a Q-SYS feature)

## Error Logs/Stack Trace
```typescript
// Line 328-329 shows the custom implementation check
if (typeof adapter.listChangeGroups !== 'function') {
  throw new Error("Change group listing not supported by this adapter");
}
```

## Root Cause Analysis
- **File(s)**: src/mcp/tools/change-groups.ts
- **Line(s)**: 314-347
- **Cause**: Design decision to add convenience method without clearly distinguishing it from standard API

## Proposed Solution
Update the tool description to clarify its MCP-specific nature:
```typescript
super(
  qrwcClient,
  "list_change_groups",
  "List all active change groups (MCP-specific tool, not part of Q-SYS API). Shows ID, control count, and auto-poll status. No parameters needed. Example: {} returns [{id:'mixer-controls',controlCount:4,hasAutoPoll:true}]. Use to monitor MCP server state and verify cleanup.",
  ListChangeGroupsParamsSchema
);
```

## Workaround
Users can track their own change groups if needed for cross-client compatibility.

## Test Cases
- [ ] Verify description clearly indicates MCP-specific nature
- [ ] Ensure documentation distinguishes standard vs custom tools
- [ ] Test error handling for unsupported adapters

## Related Issues
- Related to: Change Group implementation

## Additional Context
- Not a functional bug, but a documentation/clarity issue
- Could affect users trying to use Change Groups with other Q-SYS clients
- May want to consider adding similar disclaimer to any other MCP-specific tools

## Acceptance Criteria
- [ ] Tool description clearly indicates MCP-specific nature
- [ ] Documentation explains which tools are Q-SYS standard vs MCP additions
- [ ] No functional changes required
- [ ] Users understand the tool's limitations

## Notes
Consider creating a separate section in documentation for MCP-specific extensions vs standard Q-SYS API mappings.

---
**Labels**: bug, change-groups, documentation, low-priority  
**Milestone**: Documentation Updates