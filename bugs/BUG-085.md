# BUG-085: Unused Variables and Parameters in Event Cache Module

**Status**: Open
**Priority**: Low
**Component**: Event Cache
**Created**: 2025-01-23

## Summary

Several files in the event cache module have unused variables, parameters, and caught errors that violate ESLint rules for code cleanliness.

## Affected Files and Issues

### 1. Unused Variables (`@typescript-eslint/no-unused-vars`)

**circular-buffer.test.ts**
- Line 83: `const filtered = buffer.filter((e) => e.value > 50);`
  - `filtered` is assigned but never used
  - `e` parameter in filter callback is never used

**manager.test.ts**
- Line 8: `import { QRWCClientAdapter } from '../../../qrwc/adapter.js';`
  - `QRWCClientAdapter` is imported but never used

**manager.ts**
- Line 1167: `const { groupId, size, priority } = bufferSizes[i];`
  - `size` is destructured but never used

### 2. Unused Caught Errors

**disk-spillover.test.ts**
- Line 36: `} catch (e) {`
- Line 64: `} catch (e) {`
  - Error variable `e` is not used or logged

## Examples

```typescript
// Current (incorrect)
try {
  await someOperation();
} catch (e) {
  // e is not used
  console.log('Operation failed');
}

// Should be:
try {
  await someOperation();
} catch (_e) {
  // Prefix with underscore to indicate intentionally unused
  console.log('Operation failed');
}

// Or better:
try {
  await someOperation();
} catch (error) {
  console.log('Operation failed:', error.message);
}
```

## Root Cause

1. **Incomplete refactoring**: Variables left after code changes
2. **Placeholder code**: Variables created for future use but never implemented
3. **Poor error handling**: Catching errors without proper logging
4. **Test code artifacts**: Variables created during debugging but not removed

## Proposed Fix

### 1. Remove Unused Variables
```typescript
// Remove unused imports
- import { QRWCClientAdapter } from '../../../qrwc/adapter.js';

// Remove unused assignments
- const filtered = buffer.filter((e) => e.value > 50);
+ buffer.filter((e) => e.value > 50); // If side effects needed
// Or remove entirely if not needed
```

### 2. Fix Unused Parameters
```typescript
// Current
const filtered = buffer.filter((e) => e.value > 50);

// If parameter needed later
const filtered = buffer.filter((_e) => true); // Prefix with underscore

// If filtering needed
const filtered = buffer.filter((e) => e.value > 50);
console.log(filtered); // Use the variable
```

### 3. Improve Error Handling
```typescript
// Current
} catch (e) {
  // Silent failure
}

// Improved
} catch (error) {
  logger.error('Operation failed', { error: error.message });
}

// Or if error truly not needed
} catch (_error) {
  // Explicitly ignored with underscore prefix
}
```

### 4. Update ESLint Configuration
```json
{
  "rules": {
    "@typescript-eslint/no-unused-vars": [
      "error",
      {
        "argsIgnorePattern": "^_",
        "varsIgnorePattern": "^_",
        "caughtErrorsIgnorePattern": "^_"
      }
    ]
  }
}
```

## Impact

- **Low**: Code cleanliness issue with no functional impact
- **Maintenance**: Unused code can confuse developers
- **Bundle Size**: Unused imports may increase bundle size slightly
- **Code Quality**: Reduces code clarity and professionalism

## Implementation Steps

1. **Run ESLint with auto-fix** for simple cases
2. **Review each unused variable** to determine if it should be:
   - Removed entirely
   - Prefixed with underscore
   - Actually used in the code
3. **Improve error handling** where errors are caught but ignored
4. **Add pre-commit hooks** to prevent unused variables