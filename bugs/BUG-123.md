# BUG-123: Multiple test failures in MCP tools integration tests

**Status**: Open  
**Severity**: High  
**Priority**: P2 (Medium)  
**Component**: MCP Tools Tests  
**Reported Date**: 2025-07-27  
**Reporter**: STEP-3.2 Implementation  
**Assignee**: Unassigned

## Summary

Multiple test failures in the MCP tools integration tests due to mismatched expectations and mock responses.

## Description

When running `npm test`, several integration tests are failing:
- Component discovery tests expect specific control formats
- Complex workflow tests expect certain mock responses
- Concurrency tests have incorrect call count expectations

## Steps to Reproduce

1. Run `npm test`
2. Observe failures in `tests/integration/mcp/tools.test.ts`
3. Tests fail with mismatched expectations

## Expected Behavior

All MCP tools integration tests should pass with properly configured mocks.

## Actual Behavior

Tests fail with:
- Expected 2 controls, received 0
- Expected "Conference Room A" design name, received undefined
- Expected 3 calls to sendCommand, received 4

## Environment

- **OS**: macOS 24.5.0
- **Node.js Version**: As configured in project
- **Project Version/Commit**: feature/step-3-2-config-validation branch

## Error Logs/Stack Trace

```
FAIL tests/integration/mcp/tools.test.ts
  ● MCP Tools Integration Tests › Component and Control Discovery Workflow › should discover components and their controls
    Expected length: 2
    Received length: 0

  ● MCP Tools Integration Tests › Complex Workflow Integration › should handle a complete audio setup workflow
    Expected: "Conference Room A"
    Received: undefined

  ● MCP Tools Integration Tests › Performance and Concurrency › should handle multiple concurrent tool calls
    Expected number of calls: 3
    Received number of calls: 4
```

## Root Cause Analysis

Tests appear to have outdated mock expectations that don't match current implementation.

## Proposed Solution

Update test mocks and expectations to match current MCP tools implementation.

## Related Issues

- May be related to recent changes in MCP tools implementation

## Acceptance Criteria

- [ ] All MCP tools integration tests pass
- [ ] Mock data matches actual tool responses
- [ ] No regression in tool functionality

---

**Labels**: bug, testing, mcp-tools, high  
**Milestone**: STEP-3.2